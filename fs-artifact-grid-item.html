<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../wc-i18n/wc-i18n.html">
<link rel="import" href="../oak-i18n-behavior/oak-i18n-behavior.html">
<link rel="import" href="audio-artifact/audio-artifact.html">
<link rel="import" href="image-artifact/image-artifact.html">
<link rel="import" href="story-artifact/story-artifact.html">
<link rel="import" href="../fs-styles/fs-styles.html">
<link rel="import" href="../oak-ajax-behavior/oak-ajax-behavior.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="../fs-metrics/fs-metrics.html">

<!-- @demo demo/index.html -->

<dom-module id='fs-artifact-grid-item'>
  <template>
    <style include='fs-styles'>
      :host {
        display: inline-block;
        --grid-item-card-width: calc(46vw - 20px);
       -moz-user-select: none;
        -khtml-user-select: none;
        -webkit-user-select: none;
        user-select: none;
        /* Required to make elements draggable in old WebKit */
        -khtml-user-drag: element;
        -webkit-user-drag: element;
      }

      [hidden] {
        display: none !important;
      }

      .title-text, .title-text:visited, .title-text:active, .title-text:focus {
        color: #333333;
        text-decoration: none;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
      }

      .title-text:hover {
        color: #333333;
      }

      .add-title-text, .add-title-text:visited, .add-title-link, .add-title-link:visited {
        color: #0060d7;
      }

      .title {
        border-top: 1px solid #CFD6D7;
        display:block;
        font-size:0.875rem;
        height: 28px;
        line-height: 1.3;
        overflow:hidden;
        padding: 2px 3px 4px;
        position:relative;
        text-align:center;
        text-overflow: ellipsis;
        @apply(--grid-item-title);
      }

      .artifact-meta {
        border-top: 1px solid #CFD6D7;
        padding: 2px;
        display:block;
        height: 32px;
        overflow: hidden;
        font-size: 0.875rem;
        text-align: center;
      }

      .title-2 {
        height: 19px;
      }

      .title-2 a {
        height: 19px;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        display: block;
      }

      .contributor {
        height: 14px;
        overflow: hidden;
        line-height:1.1;
        text-overflow: ellipsis;
        white-space: nowrap;
        font-size: .88rem;
      }

      .contributor .contributor-name {
        color: blue;
        text-overflow: ellipsis;
      }

      .contributor-name:hover {
        text-decoration: underline;
      }

      .title a, .title-2 a {
        text-decoration: none;
        overflow: hidden;
      }

      .title a:hover, title-2 a:hover {
        text-decoration: underline;
      }

      .add-icon {
        background-image: url('data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJBcnQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMjVweCIgaGVpZ2h0PSIyNXB4IiB2aWV3Qm94PSIwIDAgMjUgMjUiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI1IDI1IiB4bWw6c3BhY2U9InByZXNlcnZlIj48ZyBpZD0iQWRkX194MjhfTV94MjlfIj48L2c+PHBhdGggZmlsbD0iIzAwNTFDNCIgZD0iTTEyLjUsMjMuOTA0Yy02LjI4OCwwLTExLjQwNC01LjExNi0xMS40MDQtMTEuNDA0UzYuMjEyLDEuMDk2LDEyLjUsMS4wOTZTMjMuOTA0LDYuMjEyLDIzLjkwNCwxMi41ICBTMTguNzg4LDIzLjkwNCwxMi41LDIzLjkwNHogTTEwLjkwNCwxOGMwLDAuODgsMC43MTYsMS41OTYsMS41OTYsMS41OTZTMTQuMDk2LDE4Ljg4LDE0LjA5NiwxOHYtMy45MDRIMTggIGMwLjg4LDAsMS41OTYtMC43MTYsMS41OTYtMS41OTZTMTguODgsMTAuOTA0LDE4LDEwLjkwNGgtMy45MDRWN2MwLTAuODgtMC43MTYtMS41OTYtMS41OTYtMS41OTZTMTAuOTA0LDYuMTIsMTAuOTA0LDd2My45MDRINyAgYy0wLjg4LDAtMS41OTYsMC43MTYtMS41OTYsMS41OTZTNi4xMiwxNC4wOTYsNywxNC4wOTZoMy45MDRWMTh6Ii8+PHJlY3QgZmlsbD0ibm9uZSIgd2lkdGg9IjI1IiBoZWlnaHQ9IjI1Ii8+PC9zdmc+');
        background-repeat: no-repeat;
        background-size: contain;
        display:inline-block;
        height:14px;
        margin: 0 3px 0 0;
        width:14px;
        position: relative;
        top: 2px;
      }

      .artifact {
        height:0;
        overflow:hidden;
        padding-top:100%;
        position: relative;
        width: 100%;
      }

      .artifact > image-artifact,
      .artifact > audio-artifact,
      .artifact > story-artifact {
        position: absolute;
        top:0;
        width:100%;
      }

      .changing-icon {
        position: absolute;
        left: calc(50% - 11px);
        top: calc(50% - 11px);
      }

      .fs-card {
        width: var(--grid-item-card-width);
        max-width: 170px;
      }

      .fs-card .fs-card__body {
        padding: 0;
        width: 100%;
        @apply(--grid-item-card-styles);
      }

      .loading-icon {
        background-image: url(data:image/gif;base64,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);
        background-repeat: no-repeat;
        background-size: contain;
        width:22px;
        height:22px;
        display:inline-block;
      }

      .memory-changing-overlay {
        display: none;
      }

      .badge-wrapper {
        position: absolute;
        width: 100%;
        text-align: center;
        margin: auto;
        bottom: 0px;
      }

      .badge {
        background-position: 6px center;
        background-repeat: no-repeat;
        background-size: 15px 15px;
        background-color: #4d4d4a;
        border-radius: 9px;
        bottom: 5px;
        box-sizing: border-box;
        color: #fff;
        display: inline-block;
        font-weight: normal;
        line-height: 1;
        min-width: 21px;
        padding: 2px 8px;
        position: relative;
        text-shadow: none;
        border: 1px solid #FFFFFF;
        font-style: normal;
      }

      .not-tagged-icon {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzUiIGhlaWdodD0iMzUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxyZWN0IGlkPSJhIiB3aWR0aD0iMzUiIGhlaWdodD0iMzUiIHJ4PSI0Ii8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHVzZSBmaWxsPSIjRkZGIiB4bGluazpocmVmPSIjYSIvPjxyZWN0IHN0cm9rZT0iIzk3OTc5NyIgeD0iLjUiIHk9Ii41IiB3aWR0aD0iMzQiIGhlaWdodD0iMzQiIHJ4PSI0Ii8+PGcgZmlsbD0iIzYzQTgwMiI+PHBhdGggZD0iTTkgMTQuNjNjLS41IDAtMS0uNC0xLTF2LThjMC0uNi41LTEgMS0xczEgLjQgMSAxdjhjMCAuNi0uNSAxLTEgMXoiLz48cGF0aCBkPSJNMTQgOS42M2MwIC42LS41IDEtMSAxSDVjLS41IDAtMS0uNC0xLTFzLjUtMSAxLTFoOGMuNSAwIDEgLjQgMSAxeiIvPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMSA5KSIgZmlsbD0iIzYzQTgwMiI+PGNpcmNsZSBjeD0iOS41IiBjeT0iNC41IiByPSI0LjUiLz48cGF0aCBkPSJNOS41IDIwYzQuNzc1IDAgOC42NDYuMDggOC42NDYtMy41MDYgMC0zLjU4Ny0zLjg3LTYuNDk0LTguNjQ2LTYuNDk0LTQuNzc1IDAtOC42NDYgMi45MDctOC42NDYgNi40OTRDLjg1NCAyMC4wOCA0LjcyNCAyMCA5LjUgMjB6Ii8+PC9nPjwvZz48L3N2Zz4=);
        background-position: center center;
        background-repeat: no-repeat;
        background-size: contain;
        bottom:5px;
        display:inline-block;
        height:35px;
        left:5px;
        position: absolute;
        width:35px;
        top: initial;
        z-index: 10;
      }

      .comment-icon {
        background-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjE0cHgiIGhlaWdodD0iMTNweCIgdmlld0JveD0iMCAwIDE0IDEzIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zOnNrZXRjaD0iaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoL25zIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggMy40LjIgKDE1ODU1KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5jb21tZW50LWV4dHJhLXNtYWxsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+PC9kZWZzPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc2tldGNoOnR5cGU9Ik1TUGFnZSI+CiAgICAgICAgPGcgaWQ9ImdyaWQtZGVmYXVsdCwtc2VsZWN0ZWQsLXVwbG9hZGluZywtZXJyb3IiIHNrZXRjaDp0eXBlPSJNU0FydGJvYXJkR3JvdXAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zMTEuMDAwMDAwLCAtNzY4LjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0iUmVjdGFuZ2xlLTgxNC0rLVJlY3RhbmdsZS0yLSstY29tbWVudC1leHRyYS1zbWFsbC0rLTItQ29weS02IiBza2V0Y2g6dHlwZT0iTVNMYXllckdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMDIuMDAwMDAwLCA3NjQuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8ZyBpZD0iUmVjdGFuZ2xlLTItKy1jb21tZW50LWV4dHJhLXNtYWxsLSstMi1Db3B5LTQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDkuMDAwMDAwLCAyLjAwMDAwMCkiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPgogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJjb21tZW50LWV4dHJhLXNtYWxsLSstMiI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxnIGlkPSJjb21tZW50LWV4dHJhLXNtYWxsIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMi4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxnIGlkPSJBcnQiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxnIGlkPSJDb21tZW50X194MjhfWFNfeDI5XyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUtcGF0aCIgeD0iMCIgeT0iMCIgd2lkdGg9IjE0IiBoZWlnaHQ9IjEzIj48L3JlY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0yLjEsOS45IEwxLDkuOSBDMC41MDQsOS45IDAuMSw5LjQ5NiAwLjEsOSBMMC4xLDQgQzAuMSwzLjUwNCAwLjUwNCwzLjEgMSwzLjEgTDIuOSwzLjEgTDIuOSw2IEMyLjksNy4xNTggMy44NDEsOC4xIDUsOC4xIEw3LDguMSBMOC43NjIsOS45IEw1LjAwOCw5LjkgTDIuMSwxMi43NjIgTDIuMSw5LjkgTDIuMSw5LjkgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik04LjA2Miw2LjkyOSBMNSw2LjkgQzQuNTA0LDYuOSA0LjEsNi40OTYgNC4xLDYgTDQuMSwxIEM0LjEsMC41MDQgNC41MDQsMC4xIDUsMC4xIEwxMywwLjEgQzEzLjQ5NiwwLjEgMTMuOSwwLjUwNCAxMy45LDEgTDEzLjksNiBDMTMuOSw2LjQ5NiAxMy40OTYsNi45IDEzLDYuOSBMMTEuOSw2LjkgTDExLjksMTAuNzU5IEw4LjA2Miw2LjkyOSBMOC4wNjIsNi45MjkgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=");
        background-position: 6px center;
        background-repeat: no-repeat;
        background-size: 15px 15px;
        background-color: #4d4d4a;
        border-radius: 9px;
        bottom: 5px;
        box-sizing: border-box;
        color: #fff;
        display: inline-block;
        font-size: 0.875rem;
        font-size: 14px;
        font-weight: normal;
        line-height: 1;
        margin: 0 4px;
        min-width: 21px;
        padding: 2px 8px 2px 26px;
        position: absolute;
        right: 5px;
        text-shadow: none;
        border: 1px solid #FFFFFF;
        font-style: normal;
      }

      .overlay {
        position: absolute;
        top:0;
        bottom: 35px;
        border-radius: 4px 4px 0 0;
        left:0;
        right:0;
        padding: 10px 10px 15px;
        background: rgba(0, 0, 0, 0.45);
      }

      .overlay-message {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: row;
      }

      .restricted {
        position: absolute;
        top: 75px;
        width: 100%;
        background: rgba(0,0,0, 0.45);
        padding: 10px 0px;
        text-align: center;
        color: white;
        z-index: 2;
      }

      .processing, .restricted, .processing > .fs-h5, .restricted span > .fs-h5 {
        color: white;
        text-align: center;
      }

      .error-processing {
        padding: 0 5px;
      }

      .error-text {
        width: 100%;
        background: #FDEEEE;
        background-repeat:no-repeat;
        background-position: 3px 5px, center;
        background-image: url(data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjIiIGJhc2VQcm9maWxlPSJ0aW55IiBpZD0iQXJ0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIg0KCSB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjIwcHgiIGhlaWdodD0iMjBweCIgdmlld0JveD0iMCAwIDIwIDIwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxyZWN0IGZpbGw9Im5vbmUiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIvPg0KPHBhdGggZmlsbD0iI0E3MUUxQSIgZD0iTTEzLjA4MywxMS4wMDNDMTMuMDM3LDExLjU1MiwxMi41NSwxMiwxMiwxMkg5Yy0wLjU1LDAtMS4wMzctMC40NDgtMS4wODMtMC45OTdMNy4wODMsMC45OTcNCglDNy4wMzcsMC40NDgsNy40NSwwLDgsMGg0Ljk5OGMwLjU1LDAsMC45NjMsMC40NDgsMC45MTcsMC45OTdMMTMuMDgzLDExLjAwM3ogTTExLjU3MywxOWMwLjU1LDAsMS4wMzQtMC40NDksMS4wNzUtMC45OTcNCglsMC4yMjUtMy4wMDZDMTIuOTE1LDE0LjQ0OSwxMi40OTgsMTQsMTEuOTQ4LDE0SDkuMDVjLTAuNTUsMC0wLjk2NiwwLjQ0OS0wLjkyNSwwLjk5N2wwLjIyNSwzLjAwNkM4LjM5MSwxOC41NTEsOC44NzUsMTksOS40MjUsMTkNCglIMTEuNTczeiIvPg0KPC9zdmc+);
        border: 1px solid #A51F1F;
        color: #A51F1F;
        padding: 7px 5px 7px 25px;
        border-radius: 4px;
        line-height: 1;
      }

      .error-text strong {
        font-weight: bold;
      }
      .title-text.error-styling {
        color: rgb(138, 36, 24);
        max-width: 85%;
        display: inline-block;
      }

      .exclamation-icon {
        background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.2%22%20baseProfile%3D%22tiny%22%20x%3D%220%22%20y%3D%220%22%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20xml%3Aspace%3D%22preserve%22%3E%3Crect%20fill%3D%22none%22%20width%3D%2220%22%20height%3D%2220%22%2F%3E%3Cpath%20fill%3D%22%23A71E1A%22%20d%3D%22M13.1%2011C13%2011.6%2012.6%2012%2012%2012H9c-0.5%200-1-0.4-1.1-1L7.1%201C7%200.4%207.5%200%208%200h5c0.6%200%201%200.4%200.9%201L13.1%2011zM11.6%2019c0.6%200%201-0.4%201.1-1l0.2-3C12.9%2014.4%2012.5%2014%2011.9%2014H9.1c-0.5%200-1%200.4-0.9%201l0.2%203C8.4%2018.6%208.9%2019%209.4%2019H11.6z%22%2F%3E%3C%2Fsvg%3E") !important;
        background-repeat: no-repeat;
        height: 20px;
        width: 16px;
        display: inline-block;
        vertical-align: top;
      }

      .title .title-input {
        padding: 1px 10px;
      }

      .info-icon {
        background-image: url(data:image/svg+xml;charset=utf-8, %3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.2%22%20baseProfile%3D%22tiny%22%20x%3D%220%22%20y%3D%220%22%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M10%2018.7c-4.8%200-8.7-3.9-8.7-8.7%200-4.8%203.9-8.7%208.7-8.7%204.8%200%208.7%203.9%208.7%208.7C18.7%2014.8%2014.8%2018.7%2010%2018.7zM9.1%207.4c-0.4%200-0.9%200.1-1.3%200.2C7.1%207.9%206.9%208.4%206.9%208.8%207%209.1%207.2%209.3%207.4%209.3c0.4%200%200.5%200.1%200.6%200.1%200%200%200.1%200.1%200.1%200.5%200%200.2%200%200.3-0.1%200.5%200%200.2-0.1%200.4-0.2%200.7l-0.7%202.5c-0.1%200.3-0.1%200.5-0.1%200.8%200%200.2%200%200.4%200%200.7%200%200.6%200.2%201.1%200.7%201.5C7.9%2016.7%208.5%2017.2%209.5%2017.2c0.5%200%201.2-0.2%201.7-0.4%200.5-0.2%200.9-0.6%200.9-1%200-0.2-0.1-0.4-0.2-0.6%20-0.1-0.1-0.2-0.1-0.3-0.1%20-0.1%200-0.3%200.1-0.4%200.1l-0.1%200c-0.4%200-0.5-0.1-0.6-0.1%200%200-0.1-0.2-0.1-0.4%200-0.1%200-0.3%200.1-0.5%200-0.2%200.1-0.5%200.1-0.7l0.7-2.5c0.1-0.3%200.1-0.5%200.2-0.8%200-0.3%200-0.5%200-0.6%200-0.6-0.2-1.1-0.7-1.5C10.4%207.6%209.8%207.4%209.1%207.4zM10.7%202.8c-0.5%200-1%200.2-1.4%200.5C8.8%203.7%208.6%204.2%208.6%204.7c0%200.5%200.2%201%200.6%201.4%200.4%200.4%200.9%200.5%201.4%200.5%200.5%200%201-0.2%201.4-0.5%200.4-0.4%200.6-0.8%200.6-1.3%200-0.5-0.2-1-0.6-1.3C11.7%203%2011.2%202.8%2010.7%202.8z%22%2F%3E%3Crect%20fill%3D%22none%22%20width%3D%2220%22%20height%3D%2220%22%2F%3E%3C%2Fsvg%3E%0D%0A);
        background-position: center;
        background-repeat: no-repeat;
        background-size: contain;
        display: inline-block;
        width: 18px;
        height: 18px;
        position: absolute;
        right: 10px;
      }

      .restricted-message-wrapper {
        width: 60%;
        display: inline-block;
      }

      @media all and (max-width: 979px) {

        .artifact-meta {
          height: 32px;
        }

        .overlay {
          bottom: 33px;
        }

        .title .title-input {
          font-size: 16px;
        }
      }

      @media all and (max-width: 767px) {
        .error-processing, .restricted, .processing {
          font-size: .88rem;
        }
      }

      @media all and (max-width: 400px) {
        .restricted {
          top: 50px;
        }
      }

      .relative {
        position: relative;
      }
    </style>
    <iron-ajax id="postTitle"
      url="[[ajaxBase]]/artifactmanager/artifacts/[[data.id]]"
      headers='[[authHeaders]]'
      method="POST"
      on-response="_handlePostTitleResponse"
      on-error="_handlePostTitleError"></iron-ajax>
    <div class="fs-card">
      <div class="fs-card__body">
        <div class="relative">
          <div id='artifact' class="artifact" on-tap="_goToItem">

            <!-- IMAGE/DOCUMENT RENDERER -->
            <template is='dom-if' if="{{_isImage(data.category)}}">
              <image-artifact image-url='[[data.thumbSquareUrl]]'></image-artifact>
            </template>

            <!-- AUDIO RENDERER -->
            <template is='dom-if' if="{{_is(data.category, 'AUDIO')}}">
              <audio-artifact audio-url='[[data.url]]' title='[[data.title]]'></audio-artifact>
            </template>

            <!-- STORY RENDERER -->
            <template is='dom-if' if="{{_isStory(data.category)}}">
              <story-artifact image-url='[[data.thumbSquareUrl]]' description='[[data.description]]' title='[[data.title]]'></story-artifact>
            </template>

            <template is="dom-if" if="[[data.tombstoned]]">
              <div class="badge-wrapper">
                <small class='badge'>[[_getRemainingDaysCount(i18n, data)]]</small>
              </div>
            </template>

            <template is="dom-if" if="[[!data.tombstoned]]">
              <i class='not-tagged-icon' hidden$='[[!_is(data.photoTagCount, 0)]]' title='[[i18n("not_tagged")]]'></i>
              <i class='comment-icon' hidden$='[[!data.commentCount]]'>[[data.commentCount]]</i>
            </template>
          </div>

          <template is='dom-if' if='[[_hideContributorName(view, showContributed, _titleInputActive)]]'>
            <div class="title" title='[[data.title]]' on-tap="_stopProp">
              <i class="exclamation-icon" hidden$="[[!_titleError]]"></i>
              <a class$="[[_calculateTitleClass(_titleError)]]" href$='[[_href]]' on-tap="_titleLinkOverride" hidden$='[[_hideTitle(data.title, _titleInputActive)]]'>[[data.title]]</a>
              <a href$='[[_href]]?focus=title' class="add-title-link" on-tap="_toggleAddTitleInput" hidden$='[[_hideAddTitle(readOnly, data.title, data.contributorCisUserId, owner, _titleInputActive)]]'>
                <i class='add-icon'></i>[[i18n('add_title')]]
              </a>
              <input class="title-input" type="text" maxlength='140' hidden$="[[!_titleInputActive]]" on-keydown="_handleEnterExitBlur" on-blur="_handleEnterExitBlur" placeholder$="[[_addTitle]]" />
            </div>
          </template>
          <!-- Contributor Name -->
            <div class="artifact-meta" hidden$="[[_hideContributorName(view, showContributed, _titleInputActive)]]">
              <div class="title-2" title='[[data.title]]' on-tap="_stopProp">
                <i class="exclamation-icon" hidden$="[[!_titleError]]"></i>
                <a class$="[[_calculateTitleClass(_titleError)]]" href$='[[_href]]' on-tap="_titleLinkOverride" hidden$='[[_hideTitle(data.title, _titleInputActive)]]'>[[data.title]]</a>
                <a href$='[[_href]]?focus=title' class="add-title-link" on-tap="_toggleAddTitleInput" hidden$='[[_hideAddTitle(readOnly, data.title, data.contributorCisUserId, owner, _titleInputActive)]]'>
                  <i class='add-icon'></i>[[i18n('add_title')]]
                </a>
              </div>
              <div class="contributor" title='[[_getContributorName(data.*)]]' hidden$='[[!_getContributorName(data.*)]]'>
                <span id='contributor-link' on-click='_openContactCard'></span>
              </div>
            </div>

          <!--Restricted-->
          <template is="dom-if" if="[[!data.tombstoned]]">
            <div class="restricted" hidden$="[[!restricted]]" on-tap='_openInfoDialog'>
              <span class="restricted-message-wrapper">
                [[i18n('restricted')]]
              </span>
              <span class="info-icon" hidden$='[[!_showRestrictedIcon]]'></span>
            </div>

            <template is='dom-if' if='[[showMessages]]'>
              <!-- Dim the thumbnail for error messages-->
              <div class='overlay' hidden$="[[!_displayMessage]]" on-tap='_goToItem'></div>

              <!--Uploading-->
              <div class="overlay overlay-message" hidden$="[[!uploading]]" on-tap='_goToItem'>
                <div class='processing'>
                  [[i18n('uploading')]]
                </div>
              </div>

              <!-- Upload Failed -->
              <div class="overlay overlay-message" hidden$="[[!uploadFailed]]" on-tap='_goToItem'>
                <div class='error-text'>
                  [[i18n('upload_failed')]]
                </div>
              </div>

              <!--Processing-->
              <div class="overlay overlay-message" hidden$="[[!processing]]" on-tap='_goToItem'>
                <div class='processing'>
                  [[i18n('processing')]]
                </div>
              </div>

              <!--Error Processing-->
              <div class="error-processing overlay overlay-message" hidden$="[[!processingFailed]]" on-tap='_goToItem'>
                <div class="error-text">
                  [[i18n('processing_fail')]]
                </div>
              </div>

              <!--Screening-->
              <div class="overlay overlay-message" hidden$="[[!screening]]" on-tap='_goToItem'>
                <div class='processing '>
                  [[i18n('screening')]]
                </div>
              </div>
            </template>
          </template>

        </div>
      </div>
    </div>
  </template>
</dom-module>
<script>
 (function() {
  Polymer({
    is: 'fs-artifact-grid-item',
    behaviors: [
      OakAJAXBehavior,
      WCI18n(),
      OakI18nBehavior,
      FsBehaviors.Metrics
    ],
    properties: {
      /**
       *
       * An artifactmanager artifact
       *
       * ```javascript
       * {
       *   "href": "./images/19687650",
       *   "category": "IMAGE",
       *   "url": "https://familysearch.org/patron/v2/TH-904-58554-804-13/dist.jpg?ctx=ArtCtxPublic",
       *   "thumbSquareUrl": "https://familysearch.org/patron/v2/TH-904-58554-804-13/thumb200.jpg?ctx=ArtCtxPublic",
       *   "title": "Demo Title",
       *   "description": "",
       *   "id": 19687650,
       *   "uploadDatetime": 1444242182000,
       *   "datesPlaces": null,
       *   "deepZoomLiteUrl": "https://familysearch.org/dzpatron/v1/TH-904-58554-804-13/scale?width=800&ctx=ArtCtxPublic",
       *   "screeningState": "APPROVED",
       *   "originalFilename": "Josh (BYU Football).jpg",
       *   "photoTagCount": 0,
       * }
       * ```
       *
       * @type {Object}
       */
      data: {
        type: Object,
        value: function() { return {}; }
      },
      /**
       * If set, enables the user to add a title inline.
      */
      inlineAddingEnabled: {
        type: Boolean,
        value: false
      },
      selectMode: {
        type: Boolean,
        value: false
      },
      /**
       * A flag to allow the contibutor
       * name to be shown
       */
      showContributed: {
        type: Boolean,
        value: false
      },
      /**
       * A flag to allow messages
       * to be shown
       */
      showMessages: {
        type: Boolean,
        value: false
      },
      /**
      * A flag for showing the restricted
      * info dialog
      */
      showRestrictedInfo: {
        type: Boolean,
        value: false
      },
      /**
      * Flag for showing the restricted icon
      */
      _showRestrictedIcon: {
        type: Boolean,
        computed: '_isOwner(showRestrictedInfo, owner, data.contributorCisUserId, restricted)'
      },
      /**
       * A state message is being displayed
       */
      _displayMessage: {
        type: Boolean,
        value: false
      },
      // State Messages
      screening: {
        type: Boolean,
        value: false
      },
      restricted: {
        type: Boolean,
        value: false
      },
      processing: {
        type: Boolean,
        value: false
      },
      processingFailed: {
        type: Boolean,
        value: false
      },
      uploading: {
        type: Boolean,
        value: false
      },
      uploadFailed: {
        type: Boolean,
        value: false
      },
      _href: {
        type: String,
        computed: '_computeHref(data.id)'
      },
      view: {
        type: String,
        value: null,
        observer: '_resetInputs'
      },
      owner: {
        type: String,
        value: ''
      },
      readOnly: {
        type: Boolean,
        value: false
      },
      /**
       * Notifier for if the add title input is active.
      */
      alertInputActive: {
        computed: '_computeIsActive(_titleInputActive)',
        notify: true
      },
      _titleInputActive: {
        type: Boolean,
        value: false
      },
      _titleError: {
        type: Boolean,
        value: false
      }
    },
    observers: [
      '_modifyState(data.*, showMessages)',
      '_translateContributor(i18n, data.*)'
    ],
    _titleLinkOverride: function(e) {
      if (this.data.tombstoned) {
        e.preventDefault();
        return;
      }
      if (this._titleError) {
        e.preventDefault();
        this._titleError = false;
        this._toggleAddTitleInput();
      }
    },
    _getRemainingDaysCount: function(i18n, data) {
      if(!i18n || !i18n('remaining_days_count') || !data) return '';
      return i18n('remaining_days_count').replace('{0}', data.daysUntilDelete);
    },
    _calculateTitleClass: function(_titleError) {
      return (_titleError) ? 'title-text error-styling' : 'title-text';
    },
    _calcParams: function(view) {
      if (this.view === 'my-memories' || this.view === 'my-archive' || this.view === 'my-favorites') {
        return "?c="+this.view;
      } else if(parseInt(this.view)) {
        return "?a="+this.view;
      } else {
        return "?a=none";
      }
    },
    _modifyState: function(data, showMessages) {
      if(!showMessages) return;
      // Reset the states
      this.uploading = false;
      this.uploadFailed = false;
      this.processing = false;
      this.processingFailed = false;
      this.screening = false;
      this.restricted = false;
      this._displayMessage = false;
      // If just uploaded without refresh
      // don't check for the state
      if (this.data.recentlyUploaded) return;

      // Check upload state first and if it is not UPLOADED, display either UPLOADING or FAILED message as appropriate
      // Check processing state next.  If not PROCESSED, display appropriate state message
      // Check screening state. If not APPROVED, display RESTRICTED or SCREENING message as appropriate
      if (this.data.uploadState == 'UPLOADING') {
        this.uploading = true;
        this._displayMessage = true;
      } else if(this.data.uploadState == 'FAILED') {
        this.uploadFailed = true;
        this._displayMessage = true;
      } else if (this.data.category !== 'AUDIO' && this.data.imageProcessingState !== 'PROCESSED' && this.data.imageProcessingState !== 'FAILED') {
        this.processing = true;
        this._displayMessage = true;
      } else if (this.data.imageProcessingState === 'FAILED') {
        this.processingFailed = true;
        this._displayMessage = true;
      } else if (this.data.screeningState !== 'APPROVED' && this.data.screeningState !== 'ESCALATE' && this.data.screeningState !== 'RESTRICTED') {
        this.screening = true;
        this._displayMessage = true;
      } else if (this.data.screeningState === 'RESTRICTED') {
        this.restricted = true;
      }
    },
    _computeIsActive: function(titleInputActive) {
      if (titleInputActive) return true;
    },
    _computeHref: function(id) {
      var origin = window.location.origin;
      var path = (origin === 'http://localhost:5000') ? '' : '/photos';
      return origin + path + '/artifacts/' + id;
    },
    _deselectItem: function() {
      this.data.selected = false;
      this.fire('gallery-deselect-all');
    },
    _handleEnterExitBlur: function(e) {
      this._stopProp(e);
      if (e.keyCode == 13 || e.key == "Enter" || e.type == "blur") {
        e.preventDefault();
        if (e.currentTarget.value.length > 0) {
          /* If the user hits the Enter key, a keydown and blur event are both fired.  Using async here
           * prevents the duplicate call to _saveTitle.  If we don't do this, metrics gets counted twice. */
          this.async(function() {
            if (e.currentTarget) {
              this._saveTitle(e.currentTarget.value);
              e.currentTarget.value = '';
            }
          });
        } else {
          this._titleInputActive = false;
        }
        this._focusTitle();
      } else if (e.keyCode === 27) {
        // Handle exit key
        e.currentTarget.value = "";
        this.set('data.title', "");
        this._titleInputActive = false;
        this._focusTitle();
      }
    },
    _handlePostTitleError:function(e) {
      this._titleError = true;
      this.fire('artifact-item-title-update-failed', e.detail.error);
    },
    _handlePostTitleResponse:function(e) {
      if (e.detail.status < 400) this.fire('artifact-item-title-updated')
    },
    _hideAddTitle: function(readOnly, title, dataOwner, inputtedOwner, titleInputActive) {
      if (readOnly || title || titleInputActive || this.data.tombstoned) return true;
      if (inputtedOwner) {
        return dataOwner !== inputtedOwner;
      }
      return false;
    },
    _hideTitle: function (title, titleInputActive) {
      return (!title || titleInputActive);
    },
    _hideContributorName: function(view, showContributed, titleInputActive) {
      if (!showContributed || titleInputActive) return true;
      return (view != 'my-favorites' && !Number(view))
    },
    _isDefault: function(category) {
      return category === 'IMAGE' || category === 'DOCUMENT'
    },
    _is: function(a, b) {
      return a == b;
    },
    _isImage: function(category) {
      if (!category) return true;
      return category === 'IMAGE' || category === 'PORTRAIT' || category === 'UNKNOWN' || category === 'ANY' ||
             category === 'DOCUMENT' || category === 'PDF';
    },
    _isStory: function(category) {
      if (!category) return false;
      return category === 'STORY' || category === 'TEXT';
    },
    _isDocument: function(category) {
      if (!category) return false;
      return category === 'DOCUMENT' || category === 'PDF';
    },
    /*
      * Takes focus away from input, so keyboard closes on mobile devices.
    */
    _focusTitle: function() {
      if (document.activeElement.blur && typeof document.activeElement.blur === 'function') document.activeElement.blur();
      this.$$('.title-text').focus();
    },
    _goToItem: function(e) {
      this._fireGoToItemMetrics(e);

      if (this.selectMode || this.data.tombstoned) return;
      e.preventDefault();
      e.stopPropagation();
      var url = this._href;

      var newTab = false;
      if (e && e.detail && e.detail.sourceEvent) {
        newTab = e.detail.sourceEvent.ctrlKey || e.detail.sourceEvent.metaKey
      }
      if (this.view === 'my-memories' || this.view === 'my-archive' || this.view === 'my-favorites') {
        url = url + "?c="+this.view;
      } else if(parseInt(this.view)) {
        url = url + "?a="+this.view;
      }
      if (newTab){
        window.open(url, '_blank').focus();
      } else {
        location = url;
      }
    },
    _resetInputs: function() {
      if (this._titleError) this._titleError = false;
      if (this.$$('.title-input')) this.$$('.title-input').value = "";
    },
    _saveTitle: function(titleText) {
      this.fireMetrics({link_name: 'Artifact: Save Title'});
      this.$.postTitle.body = {
        title: titleText
      };
      this.$.postTitle.generateRequest();
      this._titleInputActive = false;
      this.set('data.title', titleText);
    },
    _stopProp: function(e) {
      if (!this.selectMode) e.stopPropagation();
    },
    _toggleAddTitleInput: function(e) {
      if (this.inlineAddingEnabled) {
        if (e) e.preventDefault();
        this._titleInputActive = true;
        // Flush dom so nothing takes the focus after the title input is focus.
        Polymer.dom.flush();
        this.$$('.title .title-input').focus();
      }
    },
    _openContactCard: function(e) {
      e.stopPropagation();
      this.fireMetrics({link_name: 'Artifact: Select Contributor Name'});
      this.fire('gallery-close-contact-card',{});
      var contactData = {'event': e, 'cisId': this.data.contributorCisUserId };
      this.fire('gallery-open-contact-card', contactData);
    },
    _translateContributor: function(i18n, data) {
      if (!this.showContributed || !data || !data.value || !i18n || !i18n('contributed_by_link')) return;
      var name = (data.value.ftUserInfo) ? data.value.ftUserInfo.contactName : data.value.contributorContactName;
      var contributor = this.$$('#contributor-link');
      if (contributor) contributor.innerHTML = i18n('contributed_by_link').replace('{0}', name);
    },
    _openInfoDialog: function(e) {
      e.stopPropagation();
      e.preventDefault();
      if (!this.showRestrictedInfo || this.owner !== this.data.contributorCisUserId) return;
      var data = {};
      data.translations = {};
      data.translations.restrictedInfo = this.i18n('restricted_info');
      data.translations.checkEmail = this.i18n('check_email');
      data.target = this.$$('.info-icon');
      this.fire('open-restricted-info', data);
    },
    _isOwner: function(ex, user, owner, restricted) {
      if (!restricted || !ex) return false;
      return (user === owner);
    },
    _getContributorName: function(data) {
      if (data && data.value) {
        return (data.value.ftUserInfo) ? data.value.ftUserInfo.contactName : data.value.contributorContactName;
      }
    },
    _fireGoToItemMetrics: function(e) {
      if (e.target.classList.contains('not-tagged-icon')) {
        this.fireMetrics({link_name: 'Artifact: Add Tag Icon'});
      }
      this.fireMetrics({link_name: 'Artifact: Click to View'});
    }
  });
})();
</script>
